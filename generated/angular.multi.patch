From 66fa84a3a7722f0ad2053eae1faf32a5e31dc886 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sun, 27 Sep 2015 14:18:50 +0300
Subject: [PATCH 01/39] Step 1: Run `meteor create`

---
 .meteor/.finished-upgraders | 12 +++++++++
 .meteor/.gitignore          |  1 +
 .meteor/.id                 |  7 +++++
 .meteor/packages            | 20 ++++++++++++++
 .meteor/platforms           |  2 ++
 .meteor/release             |  1 +
 .meteor/versions            | 66 +++++++++++++++++++++++++++++++++++++++++++++
 simple-todos-angular.css    |  1 +
 simple-todos-angular.html   | 14 ++++++++++
 simple-todos-angular.js     | 23 ++++++++++++++++
 10 files changed, 147 insertions(+)
 create mode 100644 .meteor/.finished-upgraders
 create mode 100644 .meteor/.gitignore
 create mode 100644 .meteor/.id
 create mode 100644 .meteor/packages
 create mode 100644 .meteor/platforms
 create mode 100644 .meteor/release
 create mode 100644 .meteor/versions
 create mode 100644 simple-todos-angular.css
 create mode 100644 simple-todos-angular.html
 create mode 100644 simple-todos-angular.js

diff --git a/.meteor/.finished-upgraders b/.meteor/.finished-upgraders
new file mode 100644
index 0000000..61ee313
--- /dev/null
+++ b/.meteor/.finished-upgraders
@@ -0,0 +1,12 @@
+# This file contains information which helps Meteor properly upgrade your
+# app when you run 'meteor update'. You should check it into version control
+# with your project.
+
+notices-for-0.9.0
+notices-for-0.9.1
+0.9.4-platform-file
+notices-for-facebook-graph-api-2
+1.2.0-standard-minifiers-package
+1.2.0-meteor-platform-split
+1.2.0-cordova-changes
+1.2.0-breaking-changes
diff --git a/.meteor/.gitignore b/.meteor/.gitignore
new file mode 100644
index 0000000..4083037
--- /dev/null
+++ b/.meteor/.gitignore
@@ -0,0 +1 @@
+local
diff --git a/.meteor/.id b/.meteor/.id
new file mode 100644
index 0000000..fef25df
--- /dev/null
+++ b/.meteor/.id
@@ -0,0 +1,7 @@
+# This file contains a token that is unique to your project.
+# Check it into your repository along with the rest of this directory.
+# It can be used for purposes such as:
+#   - ensuring you don't accidentally deploy one app on top of another
+#   - providing package authors with aggregated statistics
+
+1szqmjtlgnfrb1a0907w
diff --git a/.meteor/packages b/.meteor/packages
new file mode 100644
index 0000000..a9f8340
--- /dev/null
+++ b/.meteor/packages
@@ -0,0 +1,20 @@
+# Meteor packages used by this project, one per line.
+# Check this file (and the other files in this directory) into your repository.
+#
+# 'meteor add' and 'meteor remove' will edit this file for you,
+# but you can also edit it by hand.
+
+meteor-base             # Packages every Meteor app needs to have
+mobile-experience       # Packages for a great mobile UX
+mongo                   # The database Meteor supports right now
+blaze-html-templates    # Compile .html files into Meteor Blaze views
+session                 # Client-side reactive dictionary for your app
+jquery                  # Helpful client-side library
+tracker                 # Meteor's client-side reactive programming library
+
+standard-minifiers      # JS/CSS minifiers run for production mode
+es5-shim                # ECMAScript 5 compatibility for older browsers.
+ecmascript              # Enable ECMAScript2015+ syntax in app code
+
+autopublish             # Publish all data to the clients (for prototyping)
+insecure                # Allow all DB writes from clients (for prototyping)
diff --git a/.meteor/platforms b/.meteor/platforms
new file mode 100644
index 0000000..efeba1b
--- /dev/null
+++ b/.meteor/platforms
@@ -0,0 +1,2 @@
+server
+browser
diff --git a/.meteor/release b/.meteor/release
new file mode 100644
index 0000000..238bbcc
--- /dev/null
+++ b/.meteor/release
@@ -0,0 +1 @@
+METEOR@1.2.0.1
diff --git a/.meteor/versions b/.meteor/versions
new file mode 100644
index 0000000..e378b68
--- /dev/null
+++ b/.meteor/versions
@@ -0,0 +1,66 @@
+autopublish@1.0.4
+autoupdate@1.2.3
+babel-compiler@5.8.24_1
+babel-runtime@0.1.4
+base64@1.0.4
+binary-heap@1.0.4
+blaze@2.1.3
+blaze-html-templates@1.0.1
+blaze-tools@1.0.4
+boilerplate-generator@1.0.4
+caching-compiler@1.0.0
+caching-html-compiler@1.0.1
+callback-hook@1.0.4
+check@1.0.6
+ddp@1.2.2
+ddp-client@1.2.1
+ddp-common@1.2.1
+ddp-server@1.2.1
+deps@1.0.9
+diff-sequence@1.0.1
+ecmascript@0.1.4
+ecmascript-collections@0.1.6
+ejson@1.0.7
+es5-shim@4.1.13
+fastclick@1.0.7
+geojson-utils@1.0.4
+hot-code-push@1.0.0
+html-tools@1.0.5
+htmljs@1.0.5
+http@1.1.1
+id-map@1.0.4
+insecure@1.0.4
+jquery@1.11.4
+launch-screen@1.0.4
+livedata@1.0.15
+logging@1.0.8
+meteor@1.1.7
+meteor-base@1.0.1
+minifiers@1.1.7
+minimongo@1.0.9
+mobile-experience@1.0.1
+mobile-status-bar@1.0.6
+mongo@1.1.1
+mongo-id@1.0.1
+npm-mongo@1.4.39_1
+observe-sequence@1.0.7
+ordered-dict@1.0.4
+promise@0.4.8
+random@1.0.4
+reactive-dict@1.1.1
+reactive-var@1.0.6
+reload@1.1.4
+retry@1.0.4
+routepolicy@1.0.6
+session@1.1.1
+spacebars@1.0.7
+spacebars-compiler@1.0.7
+standard-minifiers@1.0.0
+templating@1.1.3
+templating-tools@1.0.0
+tracker@1.0.8
+ui@1.0.8
+underscore@1.0.4
+url@1.0.5
+webapp@1.2.2
+webapp-hashing@1.0.5
diff --git a/simple-todos-angular.css b/simple-todos-angular.css
new file mode 100644
index 0000000..b6b4052
--- /dev/null
+++ b/simple-todos-angular.css
@@ -0,0 +1 @@
+/* CSS declarations go here */
diff --git a/simple-todos-angular.html b/simple-todos-angular.html
new file mode 100644
index 0000000..30ca9b0
--- /dev/null
+++ b/simple-todos-angular.html
@@ -0,0 +1,14 @@
+<head>
+  <title>simple-todos-angular</title>
+</head>
+
+<body>
+  <h1>Welcome to Meteor!</h1>
+
+  {{> hello}}
+</body>
+
+<template name="hello">
+  <button>Click Me</button>
+  <p>You've pressed the button {{counter}} times.</p>
+</template>
diff --git a/simple-todos-angular.js b/simple-todos-angular.js
new file mode 100644
index 0000000..4f8c65d
--- /dev/null
+++ b/simple-todos-angular.js
@@ -0,0 +1,23 @@
+if (Meteor.isClient) {
+  // counter starts at 0
+  Session.setDefault('counter', 0);
+
+  Template.hello.helpers({
+    counter: function () {
+      return Session.get('counter');
+    }
+  });
+
+  Template.hello.events({
+    'click button': function () {
+      // increment the counter when button is clicked
+      Session.set('counter', Session.get('counter') + 1);
+    }
+  });
+}
+
+if (Meteor.isServer) {
+  Meteor.startup(function () {
+    // code to run on server at startup
+  });
+}
-- 
2.3.8 (Apple Git-58)


From 16b95fd27ab756495e1bdf55c40800ede348ae7c Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sun, 27 Sep 2015 14:27:04 +0300
Subject: [PATCH 02/39] Step 2.1: Add the Angular package

---
 .meteor/packages | 1 +
 .meteor/versions | 4 ++++
 2 files changed, 5 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index a9f8340..03949b6 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,3 +18,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
+angular
diff --git a/.meteor/versions b/.meteor/versions
index e378b68..a702ca4 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,5 @@
+angular@1.0.0-rc.11
+angular:angular@1.4.6
 autopublish@1.0.4
 autoupdate@1.2.3
 babel-compiler@5.8.24_1
@@ -12,6 +14,7 @@ caching-compiler@1.0.0
 caching-html-compiler@1.0.1
 callback-hook@1.0.4
 check@1.0.6
+dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
 ddp-common@1.2.1
@@ -31,6 +34,7 @@ http@1.1.1
 id-map@1.0.4
 insecure@1.0.4
 jquery@1.11.4
+lai:collection-extensions@0.1.4
 launch-screen@1.0.4
 livedata@1.0.15
 logging@1.0.8
-- 
2.3.8 (Apple Git-58)


From 33e0dfed2e4708603d083a73d4552a60f2f5c545 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 12:44:07 +0300
Subject: [PATCH 03/39] Step 2.2: Link main file to Angular templates

---
 simple-todos-angular.html | 14 ++++----------
 1 file changed, 4 insertions(+), 10 deletions(-)

diff --git a/simple-todos-angular.html b/simple-todos-angular.html
index 30ca9b0..f1391a5 100644
--- a/simple-todos-angular.html
+++ b/simple-todos-angular.html
@@ -1,14 +1,8 @@
 <head>
-  <title>simple-todos-angular</title>
+  <title>Todo List</title>
 </head>
 
-<body>
-  <h1>Welcome to Meteor!</h1>
-
-  {{> hello}}
+<body ng-app="simple-todos"
+      ng-include="'todos-list.ng.html'"
+      ng-controller="TodosListCtrl">
 </body>
-
-<template name="hello">
-  <button>Click Me</button>
-  <p>You've pressed the button {{counter}} times.</p>
-</template>
-- 
2.3.8 (Apple Git-58)


From 62bd145d7c4ae0a31288c6d65c451ee5cd680997 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 12:46:44 +0300
Subject: [PATCH 04/39] Step 2.3: Init Angular app and controller

---
 simple-todos-angular.js | 29 +++++++++++------------------
 1 file changed, 11 insertions(+), 18 deletions(-)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 4f8c65d..fa676f2 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -1,23 +1,16 @@
 if (Meteor.isClient) {
-  // counter starts at 0
-  Session.setDefault('counter', 0);
 
-  Template.hello.helpers({
-    counter: function () {
-      return Session.get('counter');
-    }
-  });
+  // This code only runs on the client
+  angular.module('simple-todos',['angular-meteor']);
 
-  Template.hello.events({
-    'click button': function () {
-      // increment the counter when button is clicked
-      Session.set('counter', Session.get('counter') + 1);
-    }
-  });
-}
+  angular.module('simple-todos').controller('TodosListCtrl', ['$scope',
+    function ($scope) {
+
+      $scope.tasks = [
+        { text: 'This is task 1' },
+        { text: 'This is task 2' },
+        { text: 'This is task 3' }
+      ];
 
-if (Meteor.isServer) {
-  Meteor.startup(function () {
-    // code to run on server at startup
-  });
+  }]);
 }
-- 
2.3.8 (Apple Git-58)


From 6d00ee43390d45ad17b463fc763b051bcc65b86d Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sun, 27 Sep 2015 14:32:33 +0300
Subject: [PATCH 05/39] Step 2.4: First Angular template

---
 todos-list.ng.html | 9 +++++++++
 1 file changed, 9 insertions(+)
 create mode 100644 todos-list.ng.html

diff --git a/todos-list.ng.html b/todos-list.ng.html
new file mode 100644
index 0000000..9df43f5
--- /dev/null
+++ b/todos-list.ng.html
@@ -0,0 +1,9 @@
+<div class="container">
+  <header>
+    <h1>Todo List</h1>
+  </header>
+
+  <ul>
+    <li ng-repeat="task in tasks">{{task.text}}</li>
+  </ul>
+</div>
-- 
2.3.8 (Apple Git-58)


From 20bd3e588a45f479f5979780d968e8115f74d283 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 12:50:26 +0300
Subject: [PATCH 06/39] Step 2.5: Add CSS

---
 simple-todos-angular.css | 126 +++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 126 insertions(+)

diff --git a/simple-todos-angular.css b/simple-todos-angular.css
index b6b4052..0bca5d2 100644
--- a/simple-todos-angular.css
+++ b/simple-todos-angular.css
@@ -1 +1,127 @@
 /* CSS declarations go here */
+body {
+  font-family: sans-serif;
+  background-color: #315481;
+  background-image: linear-gradient(to bottom, #315481, #918e82 100%);
+  background-attachment: fixed;
+
+  position: absolute;
+  top: 0;
+  bottom: 0;
+  left: 0;
+  right: 0;
+
+  padding: 0;
+  margin: 0;
+
+  font-size: 14px;
+}
+
+.container {
+  max-width: 600px;
+  margin: 0 auto;
+  min-height: 100%;
+  background: white;
+}
+
+header {
+  background: #d2edf4;
+  background-image: linear-gradient(to bottom, #d0edf5, #e1e5f0 100%);
+  padding: 20px 15px 15px 15px;
+  position: relative;
+}
+
+#login-buttons {
+  display: block;
+}
+
+h1 {
+  font-size: 1.5em;
+  margin: 0;
+  margin-bottom: 10px;
+  display: inline-block;
+  margin-right: 1em;
+}
+
+form {
+  margin-top: 10px;
+  margin-bottom: -10px;
+  position: relative;
+}
+
+.new-task input {
+  box-sizing: border-box;
+  padding: 10px 0;
+  background: transparent;
+  border: none;
+  width: 100%;
+  padding-right: 80px;
+  font-size: 1em;
+}
+
+.new-task input:focus{
+  outline: 0;
+}
+
+ul {
+  margin: 0;
+  padding: 0;
+  background: white;
+}
+
+.delete {
+  float: right;
+  font-weight: bold;
+  background: none;
+  font-size: 1em;
+  border: none;
+  position: relative;
+}
+
+li {
+  position: relative;
+  list-style: none;
+  padding: 15px;
+  border-bottom: #eee solid 1px;
+}
+
+li .text {
+  margin-left: 10px;
+}
+
+li.checked {
+  color: #888;
+}
+
+li.checked .text {
+  text-decoration: line-through;
+}
+
+li.private {
+  background: #eee;
+  border-color: #ddd;
+}
+
+header .hide-completed {
+  float: right;
+}
+
+.toggle-private {
+  margin-left: 5px;
+}
+
+@media (max-width: 600px) {
+  li {
+    padding: 12px 15px;
+  }
+
+  .search {
+    width: 150px;
+    clear: both;
+  }
+
+  .new-task input {
+    padding-bottom: 5px;
+  }
+}
+
-- 
2.3.8 (Apple Git-58)


From fe4c8778be9941cf31c4360fe5edd44b71cd7314 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 12:56:31 +0300
Subject: [PATCH 07/39] Step 3.1: Replace the static array with a Collection

---
 simple-todos-angular.js | 14 ++++++--------
 1 file changed, 6 insertions(+), 8 deletions(-)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index fa676f2..9a9b236 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -1,16 +1,14 @@
+Tasks = new Mongo.Collection('tasks');
+
 if (Meteor.isClient) {
 
   // This code only runs on the client
   angular.module('simple-todos',['angular-meteor']);
 
-  angular.module('simple-todos').controller('TodosListCtrl', ['$scope',
-    function ($scope) {
+  angular.module('simple-todos').controller('TodosListCtrl', ['$scope', '$meteor',
+    function ($scope, $meteor) {
 
-      $scope.tasks = [
-        { text: 'This is task 1' },
-        { text: 'This is task 2' },
-        { text: 'This is task 3' }
-      ];
+      $scope.tasks = $meteor.collection(Tasks);
 
-  }]);
+    }]);
 }
-- 
2.3.8 (Apple Git-58)


From b9e31524b6825ae75df8eddecdbfc388d38e6619 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 12:58:59 +0300
Subject: [PATCH 08/39] Step 4.1: Add new task form to template

---
 todos-list.ng.html | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/todos-list.ng.html b/todos-list.ng.html
index 9df43f5..52cdfb2 100644
--- a/todos-list.ng.html
+++ b/todos-list.ng.html
@@ -1,6 +1,12 @@
 <div class="container">
   <header>
     <h1>Todo List</h1>
+
+    <!-- add a form below the h1 -->
+    <form class="new-task" ng-submit="addTask(newTask); newTask='';">
+      <input ng-model="newTask" type="text"
+             name="text" placeholder="Type to add new tasks" />
+    </form>
   </header>
 
   <ul>
-- 
2.3.8 (Apple Git-58)


From cfc2a3af1d558a88ed7b8243efcc26e3a9d43460 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:00:30 +0300
Subject: [PATCH 09/39] Step 4.2: Create Add Task scope function

---
 simple-todos-angular.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 9a9b236..e9dc878 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -10,5 +10,12 @@ if (Meteor.isClient) {
 
       $scope.tasks = $meteor.collection(Tasks);
 
+      $scope.addTask = function (newTask) {
+        $scope.tasks.push( {
+          text: newTask,
+          createdAt: new Date() }
+        );
+      };
+
     }]);
 }
-- 
2.3.8 (Apple Git-58)


From d51818f027309c233b6c82a0691d74da5a614864 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:01:36 +0300
Subject: [PATCH 10/39] Step 4.3: Sort task list by date

---
 simple-todos-angular.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index e9dc878..36ab6d1 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -8,7 +8,9 @@ if (Meteor.isClient) {
   angular.module('simple-todos').controller('TodosListCtrl', ['$scope', '$meteor',
     function ($scope, $meteor) {
 
-      $scope.tasks = $meteor.collection(Tasks);
+      $scope.tasks = $meteor.collection( function() {
+        return Tasks.find({}, { sort: { createdAt: -1 } })
+      });
 
       $scope.addTask = function (newTask) {
         $scope.tasks.push( {
-- 
2.3.8 (Apple Git-58)


From 89f31a3e90112d31729b99d1fc8e5afe1ca5ce2f Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:04:21 +0300
Subject: [PATCH 11/39] Step 5.1: Add done and delete buttons to task

---
 todos-list.ng.html | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/todos-list.ng.html b/todos-list.ng.html
index 52cdfb2..37b7a4a 100644
--- a/todos-list.ng.html
+++ b/todos-list.ng.html
@@ -10,6 +10,12 @@
   </header>
 
   <ul>
-    <li ng-repeat="task in tasks">{{task.text}}</li>
+    <li ng-repeat="task in tasks" ng-class="{'checked': task.checked}">
+      <button class="delete" ng-click="tasks.remove(task)">&times;</button>
+
+      <input type="checkbox" ng-model="task.checked" class="toggle-checked" />
+
+      <span class="text">{{task.text}}</span>
+    </li>
   </ul>
 </div>
-- 
2.3.8 (Apple Git-58)


From e0689052b0c5547ea709f8de698617eb63691657 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:08:33 +0300
Subject: [PATCH 12/39] Step 7.1: Remove ng-app

---
 simple-todos-angular.html | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/simple-todos-angular.html b/simple-todos-angular.html
index f1391a5..e43eceb 100644
--- a/simple-todos-angular.html
+++ b/simple-todos-angular.html
@@ -2,7 +2,6 @@
   <title>Todo List</title>
 </head>
 
-<body ng-app="simple-todos"
-      ng-include="'todos-list.ng.html'"
+<body ng-include="'todos-list.ng.html'"
       ng-controller="TodosListCtrl">
 </body>
-- 
2.3.8 (Apple Git-58)


From 1d0204da487d07056d2a491dbb2249517884abed Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:11:07 +0300
Subject: [PATCH 13/39] Step 7.2: Bootstrap Angular to mobile as well

---
 simple-todos-angular.js | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 36ab6d1..b002918 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -5,6 +5,15 @@ if (Meteor.isClient) {
   // This code only runs on the client
   angular.module('simple-todos',['angular-meteor']);
 
+  function onReady() {
+    angular.bootstrap(document, ['simple-todos']);
+  }
+
+  if (Meteor.isCordova)
+    angular.element(document).on('deviceready', onReady);
+  else
+    angular.element(document).ready(onReady);
+
   angular.module('simple-todos').controller('TodosListCtrl', ['$scope', '$meteor',
     function ($scope, $meteor) {
 
-- 
2.3.8 (Apple Git-58)


From 05e883af174064662e57b66e29a3f0adc2eeb484 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:13:14 +0300
Subject: [PATCH 14/39] Step 8.1: Add hideComplete checkbox to template

---
 todos-list.ng.html | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/todos-list.ng.html b/todos-list.ng.html
index 37b7a4a..4c5a8c7 100644
--- a/todos-list.ng.html
+++ b/todos-list.ng.html
@@ -2,6 +2,11 @@
   <header>
     <h1>Todo List</h1>
 
+    <label class="hide-completed">
+      <input type="checkbox" ng-model="$parent.hideCompleted"/>
+      Hide Completed Tasks
+    </label>
+
     <!-- add a form below the h1 -->
     <form class="new-task" ng-submit="addTask(newTask); newTask='';">
       <input ng-model="newTask" type="text"
-- 
2.3.8 (Apple Git-58)


From f04549f207754bcc187216363e086b96e4532978 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:14:54 +0300
Subject: [PATCH 15/39] Step 8.2: Watch hideCompleted and change the query
 variable

---
 simple-todos-angular.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index b002918..e759172 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -28,5 +28,12 @@ if (Meteor.isClient) {
         );
       };
 
+      $scope.$watch('hideCompleted', function() {
+        if ($scope.hideCompleted)
+          $scope.query = {checked: {$ne: true}};
+        else
+          $scope.query = {};
+      });
+
     }]);
 }
-- 
2.3.8 (Apple Git-58)


From 67416034b2d4f8974f95bf93cfd1ead4bd290db4 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:17:07 +0300
Subject: [PATCH 16/39] Step 8.3: Change the Collection to use query parameter

---
 simple-todos-angular.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index e759172..071be1f 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -17,8 +17,8 @@ if (Meteor.isClient) {
   angular.module('simple-todos').controller('TodosListCtrl', ['$scope', '$meteor',
     function ($scope, $meteor) {
 
-      $scope.tasks = $meteor.collection( function() {
-        return Tasks.find({}, { sort: { createdAt: -1 } })
+      $scope.tasks = $meteor.collection(function() {
+        return Tasks.find($scope.query, {sort: {createdAt: -1}})
       });
 
       $scope.addTask = function (newTask) {
-- 
2.3.8 (Apple Git-58)


From dd6fb8fe927779fd2b501b36cf72c3c266ae21b5 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:17:59 +0300
Subject: [PATCH 17/39] Step 8.4: Make query parameter reactive

---
 simple-todos-angular.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 071be1f..24c55fa 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -18,7 +18,7 @@ if (Meteor.isClient) {
     function ($scope, $meteor) {
 
       $scope.tasks = $meteor.collection(function() {
-        return Tasks.find($scope.query, {sort: {createdAt: -1}})
+        return Tasks.find($scope.getReactively('query'), {sort: {createdAt: -1}})
       });
 
       $scope.addTask = function (newTask) {
-- 
2.3.8 (Apple Git-58)


From e094f1b07119eb477f1a29a15a66adb7747ec394 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:19:38 +0300
Subject: [PATCH 18/39] Step 8.5: Add incompleteCount to scope

---
 simple-todos-angular.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 24c55fa..5934036 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -35,5 +35,9 @@ if (Meteor.isClient) {
           $scope.query = {};
       });
 
+      $scope.incompleteCount = function () {
+        return Tasks.find({ checked: {$ne: true} }).count();
+      };
+
     }]);
 }
-- 
2.3.8 (Apple Git-58)


From 319bc077190a51ce9be4b423df67d6ff48522099 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:21:13 +0300
Subject: [PATCH 19/39] Step 8.6: Add incompleteCount to header

---
 todos-list.ng.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/todos-list.ng.html b/todos-list.ng.html
index 4c5a8c7..a515c63 100644
--- a/todos-list.ng.html
+++ b/todos-list.ng.html
@@ -1,6 +1,6 @@
 <div class="container">
   <header>
-    <h1>Todo List</h1>
+    <h1>Todo List ( {{ incompleteCount() }} )</h1>
 
     <label class="hide-completed">
       <input type="checkbox" ng-model="$parent.hideCompleted"/>
-- 
2.3.8 (Apple Git-58)


From b41def3f80c384bd2687d4470ef305ff0cb3a5d0 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sun, 27 Sep 2015 14:59:26 +0300
Subject: [PATCH 20/39] Step 9.1: Add accounts-ui and accounts-password
 packages

---
 .meteor/packages |  2 ++
 .meteor/versions | 13 +++++++++++++
 2 files changed, 15 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 03949b6..d4fb217 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,5 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
 angular
+accounts-ui
+accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index a702ca4..2e8f00b 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,7 @@
+accounts-base@1.2.1
+accounts-password@1.1.3
+accounts-ui@1.1.6
+accounts-ui-unstyled@1.1.8
 angular@1.0.0-rc.11
 angular:angular@1.4.6
 autopublish@1.0.4
@@ -18,12 +22,14 @@ dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
 ddp-common@1.2.1
+ddp-rate-limiter@1.0.0
 ddp-server@1.2.1
 deps@1.0.9
 diff-sequence@1.0.1
 ecmascript@0.1.4
 ecmascript-collections@0.1.6
 ejson@1.0.7
+email@1.0.7
 es5-shim@4.1.13
 fastclick@1.0.7
 geojson-utils@1.0.4
@@ -36,7 +42,9 @@ insecure@1.0.4
 jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
+less@2.5.0_2
 livedata@1.0.15
+localstorage@1.0.5
 logging@1.0.8
 meteor@1.1.7
 meteor-base@1.0.1
@@ -46,19 +54,24 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.1
 mongo-id@1.0.1
+npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
 observe-sequence@1.0.7
 ordered-dict@1.0.4
 promise@0.4.8
 random@1.0.4
+rate-limit@1.0.0
 reactive-dict@1.1.1
 reactive-var@1.0.6
 reload@1.1.4
 retry@1.0.4
 routepolicy@1.0.6
+service-configuration@1.0.5
 session@1.1.1
+sha@1.0.4
 spacebars@1.0.7
 spacebars-compiler@1.0.7
+srp@1.0.4
 standard-minifiers@1.0.0
 templating@1.1.3
 templating-tools@1.0.0
-- 
2.3.8 (Apple Git-58)


From 5f5816cf03c6bf709862f580bca1b955567fc81a Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sun, 27 Sep 2015 15:08:35 +0300
Subject: [PATCH 21/39] Step 9.2: Add the urigo:angular-blaze-template package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index d4fb217..2833ad1 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -21,3 +21,4 @@ insecure                # Allow all DB writes from clients (for prototyping)
 angular
 accounts-ui
 accounts-password
+urigo:angular-blaze-template
diff --git a/.meteor/versions b/.meteor/versions
index 2e8f00b..9a60e0e 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -78,6 +78,7 @@ templating-tools@1.0.0
 tracker@1.0.8
 ui@1.0.8
 underscore@1.0.4
+urigo:angular-blaze-template@0.0.1
 url@1.0.5
 webapp@1.2.2
 webapp-hashing@1.0.5
-- 
2.3.8 (Apple Git-58)


From e9c7eaa065b5046a7ec4f9d138911ecfd486a18f Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sun, 27 Sep 2015 15:16:54 +0300
Subject: [PATCH 22/39] Step 9.3: Add Blaze loginButtons template to HTML

---
 todos-list.ng.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/todos-list.ng.html b/todos-list.ng.html
index a515c63..5fed06a 100644
--- a/todos-list.ng.html
+++ b/todos-list.ng.html
@@ -7,6 +7,8 @@
       Hide Completed Tasks
     </label>
 
+    <blaze-template name="loginButtons"></blaze-template>
+
     <!-- add a form below the h1 -->
     <form class="new-task" ng-submit="addTask(newTask); newTask='';">
       <input ng-model="newTask" type="text"
-- 
2.3.8 (Apple Git-58)


From ce33db4e17f0e04af05762e0e14395b899dbea83 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:27:12 +0300
Subject: [PATCH 23/39] Step 9.4: Configure accounts UI to use usernames
 instead of email

---
 simple-todos-angular.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 5934036..0c2d6c1 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -2,6 +2,10 @@ Tasks = new Mongo.Collection('tasks');
 
 if (Meteor.isClient) {
 
+  Accounts.ui.config({
+    passwordSignupFields: "USERNAME_ONLY"
+  });
+
   // This code only runs on the client
   angular.module('simple-todos',['angular-meteor']);
 
-- 
2.3.8 (Apple Git-58)


From 365ac0ccbb0f01e874330deb922966a5fd6b16a2 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:29:48 +0300
Subject: [PATCH 24/39] Step 9.5: Add owner and username to created task

---
 simple-todos-angular.js | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 0c2d6c1..d0b3829 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -25,10 +25,12 @@ if (Meteor.isClient) {
         return Tasks.find($scope.getReactively('query'), {sort: {createdAt: -1}})
       });
 
-      $scope.addTask = function (newTask) {
+      $scope.addTask = function(newTask) {
         $scope.tasks.push( {
-          text: newTask,
-          createdAt: new Date() }
+            text: newTask,
+            createdAt: new Date(),             // current time
+            owner: Meteor.userId(),            // _id of logged in user
+            username: Meteor.user().username }  // username of logged in user
         );
       };
 
-- 
2.3.8 (Apple Git-58)


From 4c4f8624c026f182469c084dd15012e83cb97ece Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:31:13 +0300
Subject: [PATCH 25/39] Step 9.6: Hide new task form if user is not logged in

---
 todos-list.ng.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/todos-list.ng.html b/todos-list.ng.html
index 5fed06a..3b7bd2a 100644
--- a/todos-list.ng.html
+++ b/todos-list.ng.html
@@ -10,7 +10,9 @@
     <blaze-template name="loginButtons"></blaze-template>
 
     <!-- add a form below the h1 -->
-    <form class="new-task" ng-submit="addTask(newTask); newTask='';">
+    <form class="new-task"
+          ng-submit="addTask(newTask); newTask='';"
+          ng-show="$root.currentUser">
       <input ng-model="newTask" type="text"
              name="text" placeholder="Type to add new tasks" />
     </form>
-- 
2.3.8 (Apple Git-58)


From 4b61854da8353b09d28aadc8965755ea8bfcb207 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 13:32:49 +0300
Subject: [PATCH 26/39] Step 9.7: Add username to the displayed task

---
 todos-list.ng.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/todos-list.ng.html b/todos-list.ng.html
index 3b7bd2a..d0bca05 100644
--- a/todos-list.ng.html
+++ b/todos-list.ng.html
@@ -24,7 +24,9 @@
 
       <input type="checkbox" ng-model="task.checked" class="toggle-checked" />
 
-      <span class="text">{{task.text}}</span>
+      <span class="text">
+        <strong>{{task.username}}</strong> - {{task.text}}
+      </span>
     </li>
   </ul>
 </div>
-- 
2.3.8 (Apple Git-58)


From 2ed0dc78bb0e37cf006c4a3d7bcc4c3fdf4e00d8 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sun, 27 Sep 2015 15:11:50 +0300
Subject: [PATCH 27/39] Step 10.1: Remove the insecure package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 2833ad1..9c46211 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -17,7 +17,6 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
-insecure                # Allow all DB writes from clients (for prototyping)
 angular
 accounts-ui
 accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index 9a60e0e..095b2d0 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -38,7 +38,6 @@ html-tools@1.0.5
 htmljs@1.0.5
 http@1.1.1
 id-map@1.0.4
-insecure@1.0.4
 jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
-- 
2.3.8 (Apple Git-58)


From 046737b0aa21bbb0eb55f92eaa35cd702e80a6e3 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 15:02:50 +0300
Subject: [PATCH 28/39] Step 10.2: Add Meteor Methods for add, delete and check
 tasks

---
 simple-todos-angular.js | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index d0b3829..4b12a5e 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -47,3 +47,25 @@ if (Meteor.isClient) {
 
     }]);
 }
+
+Meteor.methods({
+  addTask: function (text) {
+    // Make sure the user is logged in before inserting a task
+    if (! Meteor.userId()) {
+      throw new Meteor.Error('not-authorized');
+    }
+
+    Tasks.insert({
+      text: text,
+      createdAt: new Date(),
+      owner: Meteor.userId(),
+      username: Meteor.user().username
+    });
+  },
+  deleteTask: function (taskId) {
+    Tasks.remove(taskId);
+  },
+  setChecked: function (taskId, setChecked) {
+    Tasks.update(taskId, { $set: { checked: setChecked} });
+  }
+});
-- 
2.3.8 (Apple Git-58)


From b613f470ba414abe5fbc9f0980d2dc7498cf91b2 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 15:05:25 +0300
Subject: [PATCH 29/39] Step 10.3: Add scope functions to call the Meteor
 methods

---
 simple-todos-angular.js | 17 ++++++++++-------
 1 file changed, 10 insertions(+), 7 deletions(-)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 4b12a5e..655fe79 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -25,13 +25,16 @@ if (Meteor.isClient) {
         return Tasks.find($scope.getReactively('query'), {sort: {createdAt: -1}})
       });
 
-      $scope.addTask = function(newTask) {
-        $scope.tasks.push( {
-            text: newTask,
-            createdAt: new Date(),             // current time
-            owner: Meteor.userId(),            // _id of logged in user
-            username: Meteor.user().username }  // username of logged in user
-        );
+      $scope.addTask = function (newTask) {
+        $meteor.call('addTask', newTask);
+      };
+
+      $scope.deleteTask = function (task) {
+        $meteor.call('deleteTask', task._id);
+      };
+
+      $scope.setChecked = function (task) {
+        $meteor.call('setChecked', task._id, !task.checked);
       };
 
       $scope.$watch('hideCompleted', function() {
-- 
2.3.8 (Apple Git-58)


From 487edb5641c0c52c18432cc33494b8093af8e92b Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 15:08:04 +0300
Subject: [PATCH 30/39] Step 10.4: Change template events to call methods

---
 todos-list.ng.html | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/todos-list.ng.html b/todos-list.ng.html
index d0bca05..bdc26ea 100644
--- a/todos-list.ng.html
+++ b/todos-list.ng.html
@@ -20,9 +20,10 @@
 
   <ul>
     <li ng-repeat="task in tasks" ng-class="{'checked': task.checked}">
-      <button class="delete" ng-click="tasks.remove(task)">&times;</button>
+      <button class="delete" ng-click="deleteTask(task)">&times;</button>
 
-      <input type="checkbox" ng-model="task.checked" class="toggle-checked" />
+      <input type="checkbox" ng-checked="task.checked"
+             ng-click="setChecked(task)" class="toggle-checked" />
 
       <span class="text">
         <strong>{{task.username}}</strong> - {{task.text}}
-- 
2.3.8 (Apple Git-58)


From 490fe55774d23212b652705826f89918d5c1b677 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sun, 27 Sep 2015 15:25:25 +0300
Subject: [PATCH 31/39] Step 11.1: Remove the autopublish package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 9c46211..ff6f9b5 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -16,7 +16,6 @@ standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 ecmascript              # Enable ECMAScript2015+ syntax in app code
 
-autopublish             # Publish all data to the clients (for prototyping)
 angular
 accounts-ui
 accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index 095b2d0..f2c82e2 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -4,7 +4,6 @@ accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
 angular@1.0.0-rc.11
 angular:angular@1.4.6
-autopublish@1.0.4
 autoupdate@1.2.3
 babel-compiler@5.8.24_1
 babel-runtime@0.1.4
-- 
2.3.8 (Apple Git-58)


From bf31c1c34d6f62f5a2dc90eeda37ff0f5d07086b Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 15:10:25 +0300
Subject: [PATCH 32/39] Step 11.2: Add server publish function to tasks

---
 simple-todos-angular.js | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 655fe79..439a148 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -72,3 +72,9 @@ Meteor.methods({
     Tasks.update(taskId, { $set: { checked: setChecked} });
   }
 });
+
+if (Meteor.isServer) {
+  Meteor.publish('tasks', function () {
+    return Tasks.find();
+  });
+}
-- 
2.3.8 (Apple Git-58)


From e4556e5933dd677b80db347f910232762ffc8edd Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 15:11:21 +0300
Subject: [PATCH 33/39] Step 11.3: Subscribe to tasks publication

---
 simple-todos-angular.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 439a148..6464ff3 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -21,6 +21,8 @@ if (Meteor.isClient) {
   angular.module('simple-todos').controller('TodosListCtrl', ['$scope', '$meteor',
     function ($scope, $meteor) {
 
+      $scope.$meteorSubscribe('tasks');
+
       $scope.tasks = $meteor.collection(function() {
         return Tasks.find($scope.getReactively('query'), {sort: {createdAt: -1}})
       });
-- 
2.3.8 (Apple Git-58)


From 617d3f90bd1769730851b9623d7e3ae45d31d9f1 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 15:53:12 +0300
Subject: [PATCH 34/39] Step 11.4: Add setPrivate button to template

---
 todos-list.ng.html | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/todos-list.ng.html b/todos-list.ng.html
index bdc26ea..4674a2c 100644
--- a/todos-list.ng.html
+++ b/todos-list.ng.html
@@ -25,6 +25,12 @@
       <input type="checkbox" ng-checked="task.checked"
              ng-click="setChecked(task)" class="toggle-checked" />
 
+      <button class="toggle-private"
+              ng-if="task.owner === $root.currentUser._id"
+              ng-click="setPrivate(task)">
+        {{task.private == true ? "Private" : "Public"}}
+      </button>
+
       <span class="text">
         <strong>{{task.username}}</strong> - {{task.text}}
       </span>
-- 
2.3.8 (Apple Git-58)


From e940423674d77b5bc33a69ad48ab9d5b89871683 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 15:54:33 +0300
Subject: [PATCH 35/39] Step 11.5: Add private CSS class to task

---
 todos-list.ng.html | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/todos-list.ng.html b/todos-list.ng.html
index 4674a2c..6b1281a 100644
--- a/todos-list.ng.html
+++ b/todos-list.ng.html
@@ -19,7 +19,8 @@
   </header>
 
   <ul>
-    <li ng-repeat="task in tasks" ng-class="{'checked': task.checked}">
+    <li ng-repeat="task in tasks" 
+        ng-class="{'checked': task.checked, 'private': task.private}">
       <button class="delete" ng-click="deleteTask(task)">&times;</button>
 
       <input type="checkbox" ng-checked="task.checked"
-- 
2.3.8 (Apple Git-58)


From 8115a811efe74c4c87f2c8b01cfb831657b68645 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 17:06:51 +0300
Subject: [PATCH 36/39] Step 11.6: Add setPrivate Meteor Method

---
 simple-todos-angular.js | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 6464ff3..0bd3853 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -72,6 +72,16 @@ Meteor.methods({
   },
   setChecked: function (taskId, setChecked) {
     Tasks.update(taskId, { $set: { checked: setChecked} });
+  },
+  setPrivate: function (taskId, setToPrivate) {
+    var task = Tasks.findOne(taskId);
+
+    // Make sure only the task owner can make a task private
+    if (task.owner !== Meteor.userId()) {
+      throw new Meteor.Error('not-authorized');
+    }
+
+    Tasks.update(taskId, { $set: { private: setToPrivate } });
   }
 });
 
-- 
2.3.8 (Apple Git-58)


From 1eafaf21e69a40d4943b5214e6d4b48bbd558e7c Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 17:08:29 +0300
Subject: [PATCH 37/39] Step 11.7: Add setPrivate scope function

---
 simple-todos-angular.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index 0bd3853..bdc75a8 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -39,6 +39,10 @@ if (Meteor.isClient) {
         $meteor.call('setChecked', task._id, !task.checked);
       };
 
+      $scope.setPrivate = function (task) {
+        $meteor.call('setPrivate', task._id, ! task.private);
+      };
+
       $scope.$watch('hideCompleted', function() {
         if ($scope.hideCompleted)
           $scope.query = {checked: {$ne: true}};
-- 
2.3.8 (Apple Git-58)


From 5daeeac68b717bac0c665aa20b15f680821e2cce Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 15:59:53 +0300
Subject: [PATCH 38/39] Step 11.8: Publish only public and owner's tasks

---
 simple-todos-angular.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index bdc75a8..a6089ab 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -91,6 +91,11 @@ Meteor.methods({
 
 if (Meteor.isServer) {
   Meteor.publish('tasks', function () {
-    return Tasks.find();
+    return Tasks.find({
+      $or: [
+        { private: {$ne: true} },
+        { owner: this.userId }
+      ]
+    });
   });
 }
-- 
2.3.8 (Apple Git-58)


From dffe7b5384c1639b5805c91e95225626fed6d0f4 Mon Sep 17 00:00:00 2001
From: Uri Goldshtein <uri.goldshtein@gmail.com>
Date: Sat, 18 Jul 2015 16:02:20 +0300
Subject: [PATCH 39/39] Step 11.9: Add extra security to methods

---
 simple-todos-angular.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/simple-todos-angular.js b/simple-todos-angular.js
index a6089ab..1d371fb 100644
--- a/simple-todos-angular.js
+++ b/simple-todos-angular.js
@@ -72,9 +72,21 @@ Meteor.methods({
     });
   },
   deleteTask: function (taskId) {
+    var task = Tasks.findOne(taskId);
+    if (task.private && task.owner !== Meteor.userId()) {
+      // If the task is private, make sure only the owner can delete it
+      throw new Meteor.Error('not-authorized');
+    }
+
     Tasks.remove(taskId);
   },
   setChecked: function (taskId, setChecked) {
+    var task = Tasks.findOne(taskId);
+    if (task.private && task.owner !== Meteor.userId()) {
+      // If the task is private, make sure only the owner can check it off
+      throw new Meteor.Error('not-authorized');
+    }
+
     Tasks.update(taskId, { $set: { checked: setChecked} });
   },
   setPrivate: function (taskId, setToPrivate) {
-- 
2.3.8 (Apple Git-58)

