From 3170e79cfa810c7e91a14440a279e5e2cd053922 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:00:51 -0700
Subject: [PATCH 01/50] Step 1: Run `meteor create`

---
 .gitignore                  |  1 +
 .meteor/.finished-upgraders | 13 +++++++++
 .meteor/.gitignore          |  1 +
 .meteor/.id                 |  7 +++++
 .meteor/packages            | 21 ++++++++++++++
 .meteor/platforms           |  2 ++
 .meteor/release             |  1 +
 .meteor/versions            | 69 +++++++++++++++++++++++++++++++++++++++++++++
 client/main.css             |  1 +
 client/main.html            | 25 ++++++++++++++++
 client/main.js              | 22 +++++++++++++++
 package.json                | 10 +++++++
 server/main.js              |  5 ++++
 13 files changed, 178 insertions(+)
 create mode 100644 .gitignore
 create mode 100644 .meteor/.finished-upgraders
 create mode 100644 .meteor/.gitignore
 create mode 100644 .meteor/.id
 create mode 100644 .meteor/packages
 create mode 100644 .meteor/platforms
 create mode 100644 .meteor/release
 create mode 100644 .meteor/versions
 create mode 100644 client/main.css
 create mode 100644 client/main.html
 create mode 100644 client/main.js
 create mode 100644 package.json
 create mode 100644 server/main.js

diff --git a/.gitignore b/.gitignore
new file mode 100644
index 0000000..c2658d7
--- /dev/null
+++ b/.gitignore
@@ -0,0 +1 @@
+node_modules/
diff --git a/.meteor/.finished-upgraders b/.meteor/.finished-upgraders
new file mode 100644
index 0000000..dacc2c0
--- /dev/null
+++ b/.meteor/.finished-upgraders
@@ -0,0 +1,13 @@
+# This file contains information which helps Meteor properly upgrade your
+# app when you run 'meteor update'. You should check it into version control
+# with your project.
+
+notices-for-0.9.0
+notices-for-0.9.1
+0.9.4-platform-file
+notices-for-facebook-graph-api-2
+1.2.0-standard-minifiers-package
+1.2.0-meteor-platform-split
+1.2.0-cordova-changes
+1.2.0-breaking-changes
+1.3.0-split-minifiers-package
diff --git a/.meteor/.gitignore b/.meteor/.gitignore
new file mode 100644
index 0000000..4083037
--- /dev/null
+++ b/.meteor/.gitignore
@@ -0,0 +1 @@
+local
diff --git a/.meteor/.id b/.meteor/.id
new file mode 100644
index 0000000..9a3be4f
--- /dev/null
+++ b/.meteor/.id
@@ -0,0 +1,7 @@
+# This file contains a token that is unique to your project.
+# Check it into your repository along with the rest of this directory.
+# It can be used for purposes such as:
+#   - ensuring you don't accidentally deploy one app on top of another
+#   - providing package authors with aggregated statistics
+
+1v2pn7n1jbklfu1hg4tnm
diff --git a/.meteor/packages b/.meteor/packages
new file mode 100644
index 0000000..d4c8001
--- /dev/null
+++ b/.meteor/packages
@@ -0,0 +1,21 @@
+# Meteor packages used by this project, one per line.
+# Check this file (and the other files in this directory) into your repository.
+#
+# 'meteor add' and 'meteor remove' will edit this file for you,
+# but you can also edit it by hand.
+
+meteor-base             # Packages every Meteor app needs to have
+mobile-experience       # Packages for a great mobile UX
+mongo                   # The database Meteor supports right now
+blaze-html-templates    # Compile .html files into Meteor Blaze views
+reactive-var            # Reactive variable for tracker
+jquery                  # Helpful client-side library
+tracker                 # Meteor's client-side reactive programming library
+
+standard-minifier-css   # CSS minifier run for production mode
+standard-minifier-js    # JS minifier run for production mode
+es5-shim                # ECMAScript 5 compatibility for older browsers.
+ecmascript              # Enable ECMAScript2015+ syntax in app code
+
+autopublish             # Publish all data to the clients (for prototyping)
+insecure                # Allow all DB writes from clients (for prototyping)
diff --git a/.meteor/platforms b/.meteor/platforms
new file mode 100644
index 0000000..efeba1b
--- /dev/null
+++ b/.meteor/platforms
@@ -0,0 +1,2 @@
+server
+browser
diff --git a/.meteor/release b/.meteor/release
new file mode 100644
index 0000000..ab70657
--- /dev/null
+++ b/.meteor/release
@@ -0,0 +1 @@
+METEOR@1.3-rc.2
diff --git a/.meteor/versions b/.meteor/versions
new file mode 100644
index 0000000..c3395d2
--- /dev/null
+++ b/.meteor/versions
@@ -0,0 +1,69 @@
+allow-deny@1.0.2-rc.2
+autopublish@1.0.5-rc.2
+autoupdate@1.2.6-rc.2
+babel-compiler@6.5.1-rc.2
+babel-runtime@0.1.6-rc.2
+base64@1.0.6-rc.2
+binary-heap@1.0.6-rc.2
+blaze@2.1.5-rc.2
+blaze-html-templates@1.0.2-rc.2
+blaze-tools@1.0.6-rc.2
+boilerplate-generator@1.0.6-rc.2
+caching-compiler@1.0.2-rc.2
+caching-html-compiler@1.0.4-rc.2
+callback-hook@1.0.6-rc.2
+check@1.1.2-rc.2
+ddp@1.2.3-rc.2
+ddp-client@1.2.3-rc.2
+ddp-common@1.2.3-rc.2
+ddp-server@1.2.4-rc.2
+deps@1.0.10-rc.2
+diff-sequence@1.0.3-rc.2
+ecmascript@0.4.1-rc.2
+ecmascript-runtime@0.2.8-rc.2
+ejson@1.0.9-rc.2
+es5-shim@4.5.8-rc.2
+fastclick@1.0.9-rc.2
+geojson-utils@1.0.6-rc.2
+hot-code-push@1.0.2-rc.2
+html-tools@1.0.7-rc.2
+htmljs@1.0.7-rc.2
+http@1.1.3-rc.2
+id-map@1.0.5-rc.2
+insecure@1.0.5-rc.2
+jquery@1.11.6-rc.2
+launch-screen@1.0.7-rc.2
+livedata@1.0.16-rc.2
+logging@1.0.10-rc.2
+meteor@1.1.12-rc.2
+meteor-base@1.0.2-rc.2
+minifier-css@1.1.9-rc.2
+minifier-js@1.1.9-rc.2
+minimongo@1.0.12-rc.2
+mobile-experience@1.0.2-rc.2
+mobile-status-bar@1.0.9-rc.2
+modules@0.5.1-rc.2
+modules-runtime@0.6.1-rc.2
+mongo@1.1.5-rc.2
+mongo-id@1.0.2-rc.2
+npm-mongo@1.4.41-rc.2
+observe-sequence@1.0.9-rc.2
+ordered-dict@1.0.5-rc.2
+promise@0.6.4-rc.2
+random@1.0.7-rc.2
+reactive-var@1.0.7-rc.2
+reload@1.1.6-rc.2
+retry@1.0.5-rc.2
+routepolicy@1.0.8-rc.2
+spacebars@1.0.9-rc.2
+spacebars-compiler@1.0.9-rc.2
+standard-minifier-css@1.0.4-rc.2
+standard-minifier-js@1.0.4-rc.2
+templating@1.1.7-rc.2
+templating-tools@1.0.2-rc.2
+tracker@1.0.11-rc.2
+ui@1.0.9-rc.2
+underscore@1.0.6-rc.2
+url@1.0.7-rc.2
+webapp@1.2.6-rc.2
+webapp-hashing@1.0.7-rc.2
diff --git a/client/main.css b/client/main.css
new file mode 100644
index 0000000..b6b4052
--- /dev/null
+++ b/client/main.css
@@ -0,0 +1 @@
+/* CSS declarations go here */
diff --git a/client/main.html b/client/main.html
new file mode 100644
index 0000000..6fe0dc5
--- /dev/null
+++ b/client/main.html
@@ -0,0 +1,25 @@
+<head>
+  <title>simple</title>
+</head>
+
+<body>
+  <h1>Welcome to Meteor!</h1>
+
+  {{> hello}}
+  {{> info}}
+</body>
+
+<template name="hello">
+  <button>Click Me</button>
+  <p>You've pressed the button {{counter}} times.</p>
+</template>
+
+<template name="info">
+  <h2>Learn Meteor!</h2>
+  <ul>
+    <li><a href="https://www.meteor.com/try">Do the Tutorial</a></li>
+    <li><a href="http://guide.meteor.com">Follow the Guide</a></li>
+    <li><a href="https://docs.meteor.com">Read the Docs</a></li>
+    <li><a href="https://forums.meteor.com">Discussions</a></li>
+  </ul>
+</template>
diff --git a/client/main.js b/client/main.js
new file mode 100644
index 0000000..ecb3282
--- /dev/null
+++ b/client/main.js
@@ -0,0 +1,22 @@
+import { Template } from 'meteor/templating';
+import { ReactiveVar } from 'meteor/reactive-var';
+
+import './main.html';
+
+Template.hello.onCreated(function helloOnCreated() {
+  // counter starts at 0
+  this.counter = new ReactiveVar(0);
+});
+
+Template.hello.helpers({
+  counter() {
+    return Template.instance().counter.get();
+  },
+});
+
+Template.hello.events({
+  'click button'(event, instance) {
+    // increment the counter when button is clicked
+    instance.counter.set(instance.counter.get() + 1);
+  },
+});
diff --git a/package.json b/package.json
new file mode 100644
index 0000000..4164b14
--- /dev/null
+++ b/package.json
@@ -0,0 +1,10 @@
+{
+  "name": "simple-todos",
+  "private": true,
+  "scripts": {
+    "start": "meteor run"
+  },
+  "dependencies": {
+    "meteor-node-stubs": "~0.2.0"
+  }
+}
diff --git a/server/main.js b/server/main.js
new file mode 100644
index 0000000..31a9e0e
--- /dev/null
+++ b/server/main.js
@@ -0,0 +1,5 @@
+import { Meteor } from 'meteor/meteor';
+
+Meteor.startup(() => {
+  // code to run on server at startup
+});
-- 
2.5.1


From 6d83eb9a65db406fe2802532d353913e6c39a3c2 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:02:01 -0700
Subject: [PATCH 02/50] Step 2.1: Add the React NPM packages

---
 package.json | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/package.json b/package.json
index 4164b14..9cb9d8e 100644
--- a/package.json
+++ b/package.json
@@ -5,6 +5,8 @@
     "start": "meteor run"
   },
   "dependencies": {
-    "meteor-node-stubs": "~0.2.0"
+    "meteor-node-stubs": "~0.2.0",
+    "react": "^0.14.7",
+    "react-dom": "^0.14.7"
   }
 }
-- 
2.5.1


From e7da3a8c525a7476fb94fd68286b7fb5348eb5b6 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:03:54 -0700
Subject: [PATCH 03/50] Step 2.2: Replace starter HTML code

---
 client/main.html | 22 ++--------------------
 1 file changed, 2 insertions(+), 20 deletions(-)

diff --git a/client/main.html b/client/main.html
index 6fe0dc5..1aae2d4 100644
--- a/client/main.html
+++ b/client/main.html
@@ -1,25 +1,7 @@
 <head>
-  <title>simple</title>
+  <title>Todo List</title>
 </head>
 
 <body>
-  <h1>Welcome to Meteor!</h1>
-
-  {{> hello}}
-  {{> info}}
+  <div id="render-target"></div>
 </body>
-
-<template name="hello">
-  <button>Click Me</button>
-  <p>You've pressed the button {{counter}} times.</p>
-</template>
-
-<template name="info">
-  <h2>Learn Meteor!</h2>
-  <ul>
-    <li><a href="https://www.meteor.com/try">Do the Tutorial</a></li>
-    <li><a href="http://guide.meteor.com">Follow the Guide</a></li>
-    <li><a href="https://docs.meteor.com">Read the Docs</a></li>
-    <li><a href="https://forums.meteor.com">Discussions</a></li>
-  </ul>
-</template>
-- 
2.5.1


From 4b91faad4fb982b4761f5562bd9e1cb8c39136f6 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:05:08 -0700
Subject: [PATCH 04/50] Step 2.3: Replace starter JS

---
 client/main.js  | 22 ----------------------
 client/main.jsx |  9 +++++++++
 2 files changed, 9 insertions(+), 22 deletions(-)
 delete mode 100644 client/main.js
 create mode 100644 client/main.jsx

diff --git a/client/main.js b/client/main.js
deleted file mode 100644
index ecb3282..0000000
--- a/client/main.js
+++ /dev/null
@@ -1,22 +0,0 @@
-import { Template } from 'meteor/templating';
-import { ReactiveVar } from 'meteor/reactive-var';
-
-import './main.html';
-
-Template.hello.onCreated(function helloOnCreated() {
-  // counter starts at 0
-  this.counter = new ReactiveVar(0);
-});
-
-Template.hello.helpers({
-  counter() {
-    return Template.instance().counter.get();
-  },
-});
-
-Template.hello.events({
-  'click button'(event, instance) {
-    // increment the counter when button is clicked
-    instance.counter.set(instance.counter.get() + 1);
-  },
-});
diff --git a/client/main.jsx b/client/main.jsx
new file mode 100644
index 0000000..9ba3d08
--- /dev/null
+++ b/client/main.jsx
@@ -0,0 +1,9 @@
+import React from 'react';
+import { Meteor } from 'meteor/meteor';
+import { render } from 'react-dom';
+
+import App from '../imports/ui/App.jsx';
+
+Meteor.startup(() => {
+  render(<App />, document.getElementById('render-target'));
+});
-- 
2.5.1


From 716c4acbf54ecdf0438a4995f2441f73c608586b Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:05:58 -0700
Subject: [PATCH 05/50] Step 2.4: Create App component

---
 imports/ui/App.jsx | 34 ++++++++++++++++++++++++++++++++++
 1 file changed, 34 insertions(+)
 create mode 100644 imports/ui/App.jsx

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
new file mode 100644
index 0000000..0f8372d
--- /dev/null
+++ b/imports/ui/App.jsx
@@ -0,0 +1,34 @@
+import React, { Component } from 'react';
+
+import Task from './Task.jsx';
+
+// App component - represents the whole app
+export default class App extends Component {
+  getTasks() {
+    return [
+      { _id: 1, text: 'This is task 1' },
+      { _id: 2, text: 'This is task 2' },
+      { _id: 3, text: 'This is task 3' },
+    ];
+  }
+
+  renderTasks() {
+    return this.getTasks().map((task) => (
+      <Task key={task._id} task={task} />
+    ));
+  }
+
+  render() {
+    return (
+      <div className="container">
+        <header>
+          <h1>Todo List</h1>
+        </header>
+
+        <ul>
+          {this.renderTasks()}
+        </ul>
+      </div>
+    );
+  }
+}
-- 
2.5.1


From 229edee7c361ca5aaebf9c916ca8163f28007d22 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:06:31 -0700
Subject: [PATCH 06/50] Step 2.5: Create Task component

---
 imports/ui/Task.jsx | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)
 create mode 100644 imports/ui/Task.jsx

diff --git a/imports/ui/Task.jsx b/imports/ui/Task.jsx
new file mode 100644
index 0000000..a5000e0
--- /dev/null
+++ b/imports/ui/Task.jsx
@@ -0,0 +1,16 @@
+import React, { Component, PropTypes } from 'react';
+
+// Task component - represents a single todo item
+export default class Task extends Component {
+  render() {
+    return (
+      <li>{this.props.task.text}</li>
+    );
+  }
+}
+
+Task.propTypes = {
+  // This component gets the task to display through a React prop.
+  // We can use propTypes to indicate it is required
+  task: PropTypes.object.isRequired,
+};
-- 
2.5.1


From 1925de765a82ddb055853c123d024acf0f55f7f8 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:07:02 -0700
Subject: [PATCH 07/50] Step 2.6: Add CSS

---
 client/main.css | 125 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 125 insertions(+)

diff --git a/client/main.css b/client/main.css
index b6b4052..cec3ae6 100644
--- a/client/main.css
+++ b/client/main.css
@@ -1 +1,126 @@
 /* CSS declarations go here */
+body {
+  font-family: sans-serif;
+  background-color: #315481;
+  background-image: linear-gradient(to bottom, #315481, #918e82 100%);
+  background-attachment: fixed;
+
+  position: absolute;
+  top: 0;
+  bottom: 0;
+  left: 0;
+  right: 0;
+
+  padding: 0;
+  margin: 0;
+
+  font-size: 14px;
+}
+
+.container {
+  max-width: 600px;
+  margin: 0 auto;
+  min-height: 100%;
+  background: white;
+}
+
+header {
+  background: #d2edf4;
+  background-image: linear-gradient(to bottom, #d0edf5, #e1e5f0 100%);
+  padding: 20px 15px 15px 15px;
+  position: relative;
+}
+
+#login-buttons {
+  display: block;
+}
+
+h1 {
+  font-size: 1.5em;
+  margin: 0;
+  margin-bottom: 10px;
+  display: inline-block;
+  margin-right: 1em;
+}
+
+form {
+  margin-top: 10px;
+  margin-bottom: -10px;
+  position: relative;
+}
+
+.new-task input {
+  box-sizing: border-box;
+  padding: 10px 0;
+  background: transparent;
+  border: none;
+  width: 100%;
+  padding-right: 80px;
+  font-size: 1em;
+}
+
+.new-task input:focus{
+  outline: 0;
+}
+
+ul {
+  margin: 0;
+  padding: 0;
+  background: white;
+}
+
+.delete {
+  float: right;
+  font-weight: bold;
+  background: none;
+  font-size: 1em;
+  border: none;
+  position: relative;
+}
+
+li {
+  position: relative;
+  list-style: none;
+  padding: 15px;
+  border-bottom: #eee solid 1px;
+}
+
+li .text {
+  margin-left: 10px;
+}
+
+li.checked {
+  color: #888;
+}
+
+li.checked .text {
+  text-decoration: line-through;
+}
+
+li.private {
+  background: #eee;
+  border-color: #ddd;
+}
+
+header .hide-completed {
+  float: right;
+}
+
+.toggle-private {
+  margin-left: 5px;
+}
+
+@media (max-width: 600px) {
+  li {
+    padding: 12px 15px;
+  }
+
+  .search {
+    width: 150px;
+    clear: both;
+  }
+
+  .new-task input {
+    padding-bottom: 5px;
+  }
+}
\ No newline at end of file
-- 
2.5.1


From 8a4bbbe38bc6cce91029e065a2e895ffef2cc084 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 15:32:35 +1100
Subject: [PATCH 08/50] Step 3.1: Create tasks collection

---
 imports/api/tasks.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/api/tasks.js

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
new file mode 100644
index 0000000..3bed819
--- /dev/null
+++ b/imports/api/tasks.js
@@ -0,0 +1,3 @@
+import { Mongo } from 'meteor/mongo';
+
+export const Tasks = new Mongo.Collection('tasks');
-- 
2.5.1


From a6c0c60d31ed2ab616041d93f85488f330c63ef7 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 15:33:03 +1100
Subject: [PATCH 09/50] Step 3.2: Load tasks collection on the server

---
 server/main.js | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

diff --git a/server/main.js b/server/main.js
index 31a9e0e..ab941a4 100644
--- a/server/main.js
+++ b/server/main.js
@@ -1,5 +1 @@
-import { Meteor } from 'meteor/meteor';
-
-Meteor.startup(() => {
-  // code to run on server at startup
-});
+import '../imports/api/tasks.js';
-- 
2.5.1


From 336b9729ec9401a79b9929c15c9d7d9a9f3f88f8 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 15:37:12 +1100
Subject: [PATCH 10/50] Step 3.3: Add react-meteor-data package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 package.json     | 1 +
 3 files changed, 3 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index d4c8001..c3506d5 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
+react-meteor-data@0.2.6-beta.16
diff --git a/.meteor/versions b/.meteor/versions
index c3395d2..c4bc9da 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -51,6 +51,7 @@ observe-sequence@1.0.9-rc.2
 ordered-dict@1.0.5-rc.2
 promise@0.6.4-rc.2
 random@1.0.7-rc.2
+react-meteor-data@0.2.6-beta.16
 reactive-var@1.0.7-rc.2
 reload@1.1.6-rc.2
 retry@1.0.5-rc.2
diff --git a/package.json b/package.json
index 9cb9d8e..fb213f3 100644
--- a/package.json
+++ b/package.json
@@ -7,6 +7,7 @@
   "dependencies": {
     "meteor-node-stubs": "~0.2.0",
     "react": "^0.14.7",
+    "react-addons-pure-render-mixin": "^0.14.7",
     "react-dom": "^0.14.7"
   }
 }
-- 
2.5.1


From 3d737848e1e9b20c4c022718cc5c0647d0f524fe Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 15:37:54 +1100
Subject: [PATCH 11/50] Step 3.4: Modify App component to get tasks from
 collection

---
 imports/ui/App.jsx | 27 ++++++++++++++++-----------
 1 file changed, 16 insertions(+), 11 deletions(-)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 0f8372d..8f1bf8b 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -1,19 +1,14 @@
-import React, { Component } from 'react';
+import React, { Component, PropTypes } from 'react';
+import { createContainer } from 'meteor/react-meteor-data';
+
+import { Tasks } from '../api/tasks.js';
 
 import Task from './Task.jsx';
 
 // App component - represents the whole app
-export default class App extends Component {
-  getTasks() {
-    return [
-      { _id: 1, text: 'This is task 1' },
-      { _id: 2, text: 'This is task 2' },
-      { _id: 3, text: 'This is task 3' },
-    ];
-  }
-
+class App extends Component {
   renderTasks() {
-    return this.getTasks().map((task) => (
+    return this.props.tasks.map((task) => (
       <Task key={task._id} task={task} />
     ));
   }
@@ -32,3 +27,13 @@ export default class App extends Component {
     );
   }
 }
+
+App.propTypes = {
+  tasks: PropTypes.array.isRequired,
+};
+
+export default createContainer(() => {
+  return {
+    tasks: Tasks.find({}).fetch(),
+  };
+}, App);
-- 
2.5.1


From 4c5eed813149be7a6bdb999406fbb3d1d1f7fe5b Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:13:37 -0700
Subject: [PATCH 12/50] Step 4.1: Add form for new tasks

---
 imports/ui/App.jsx | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 8f1bf8b..c452da9 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -18,6 +18,14 @@ class App extends Component {
       <div className="container">
         <header>
           <h1>Todo List</h1>
+
+          <form className="new-task" onSubmit={this.handleSubmit.bind(this)} >
+            <input
+              type="text"
+              ref="textInput"
+              placeholder="Type to add new tasks"
+            />
+          </form>
         </header>
 
         <ul>
-- 
2.5.1


From 864c1a4d6ad581b0f6186f609fc079fa110d0a8d Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:14:08 -0700
Subject: [PATCH 13/50] Step 4.2: Add handleSubmit method to App component

---
 imports/ui/App.jsx | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index c452da9..332bd6e 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -1,4 +1,5 @@
 import React, { Component, PropTypes } from 'react';
+import ReactDOM from 'react-dom';
 import { createContainer } from 'meteor/react-meteor-data';
 
 import { Tasks } from '../api/tasks.js';
@@ -7,6 +8,21 @@ import Task from './Task.jsx';
 
 // App component - represents the whole app
 class App extends Component {
+  handleSubmit(event) {
+    event.preventDefault();
+
+    // Find the text field via the React ref
+    const text = ReactDOM.findDOMNode(this.refs.textInput).value.trim();
+
+    Tasks.insert({
+      text,
+      createdAt: new Date(), // current time
+    });
+
+    // Clear form
+    ReactDOM.findDOMNode(this.refs.textInput).value = '';
+  }
+
   renderTasks() {
     return this.props.tasks.map((task) => (
       <Task key={task._id} task={task} />
-- 
2.5.1


From 5f82b1fe53e3e76377b9045406715e6da1b68c38 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:14:40 -0700
Subject: [PATCH 14/50] Step 4.3: Update data container to sort tasks by time

---
 imports/ui/App.jsx | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 332bd6e..546d198 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -58,6 +58,6 @@ App.propTypes = {
 
 export default createContainer(() => {
   return {
-    tasks: Tasks.find({}).fetch(),
+    tasks: Tasks.find({}, { sort: { createdAt: -1 } }).fetch(),
   };
 }, App);
-- 
2.5.1


From 0112f93e63ab2de02b5c10a6e89f1b38dda126f0 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:17:06 -0700
Subject: [PATCH 15/50] Step 5.1: Update Task component to add features

---
 imports/ui/Task.jsx | 32 +++++++++++++++++++++++++++++++-
 1 file changed, 31 insertions(+), 1 deletion(-)

diff --git a/imports/ui/Task.jsx b/imports/ui/Task.jsx
index a5000e0..3140871 100644
--- a/imports/ui/Task.jsx
+++ b/imports/ui/Task.jsx
@@ -1,10 +1,40 @@
 import React, { Component, PropTypes } from 'react';
 
+import { Tasks } from '../api/tasks.js';
+
 // Task component - represents a single todo item
 export default class Task extends Component {
+  toggleChecked() {
+    // Set the checked property to the opposite of its current value
+    Tasks.update(this.props.task._id, {
+      $set: { checked: !this.props.task.checked },
+    });
+  }
+
+  deleteThisTask() {
+    Tasks.remove(this.props.task._id);
+  }
+
   render() {
+    // Give tasks a different className when they are checked off,
+    // so that we can style them nicely in CSS
+    const taskClassName = this.props.task.checked ? 'checked' : '';
+
     return (
-      <li>{this.props.task.text}</li>
+      <li className={taskClassName}>
+        <button className="delete" onClick={this.deleteThisTask.bind(this)}>
+          &times;
+        </button>
+
+        <input
+          type="checkbox"
+          readOnly
+          checked={this.props.task.checked}
+          onClick={this.toggleChecked.bind(this)}
+        />
+
+        <span className="text">{this.props.task.text}</span>
+      </li>
     );
   }
 }
-- 
2.5.1


From 8cb48d9c1280f5feda7aff06c385a52dedad832d Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:21:30 -0700
Subject: [PATCH 16/50] Step 7.1: Add hide completed checkbox to App component

---
 imports/ui/App.jsx | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 546d198..31d7564 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -35,6 +35,16 @@ class App extends Component {
         <header>
           <h1>Todo List</h1>
 
+          <label className="hide-completed">
+            <input
+              type="checkbox"
+              readOnly
+              checked={this.state.hideCompleted}
+              onClick={this.toggleHideCompleted.bind(this)}
+            />
+            Hide Completed Tasks
+          </label>
+
           <form className="new-task" onSubmit={this.handleSubmit.bind(this)} >
             <input
               type="text"
-- 
2.5.1


From b18b0fbb35c8122b4f70ff0dc3dbef2e40a55a32 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:22:07 -0700
Subject: [PATCH 17/50] Step 7.2: Add intial state to App component

---
 imports/ui/App.jsx | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 31d7564..246ad81 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -8,6 +8,14 @@ import Task from './Task.jsx';
 
 // App component - represents the whole app
 class App extends Component {
+  constructor(props) {
+    super(props);
+
+    this.state = {
+      hideCompleted: false,
+    };
+  }
+
   handleSubmit(event) {
     event.preventDefault();
 
-- 
2.5.1


From 5b70edbfa243329bdb28710ca79a0377b967823f Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:22:32 -0700
Subject: [PATCH 18/50] Step 7.3: Add toggleHideCompleted handler to App

---
 imports/ui/App.jsx | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 246ad81..3347daf 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -31,6 +31,12 @@ class App extends Component {
     ReactDOM.findDOMNode(this.refs.textInput).value = '';
   }
 
+  toggleHideCompleted() {
+    this.setState({
+      hideCompleted: !this.state.hideCompleted,
+    });
+  }
+
   renderTasks() {
     return this.props.tasks.map((task) => (
       <Task key={task._id} task={task} />
-- 
2.5.1


From 241e553fc3889c682eb04521819c8e51f2dcbc68 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:23:02 -0700
Subject: [PATCH 19/50] Step 7.4: Filter tasks in renderTasks

---
 imports/ui/App.jsx | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 3347daf..1500877 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -38,7 +38,11 @@ class App extends Component {
   }
 
   renderTasks() {
-    return this.props.tasks.map((task) => (
+    let filteredTasks = this.props.tasks;
+    if (this.state.hideCompleted) {
+      filteredTasks = filteredTasks.filter(task => !task.checked);
+    }
+    return filteredTasks.map((task) => (
       <Task key={task._id} task={task} />
     ));
   }
-- 
2.5.1


From 307d94f24be2dde5b94faf93e4d285e02f53001e Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:23:44 -0700
Subject: [PATCH 20/50] Step 7.5: Update data container to return
 incompleteCount

---
 imports/ui/App.jsx | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 1500877..75714e5 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -87,5 +87,6 @@ App.propTypes = {
 export default createContainer(() => {
   return {
     tasks: Tasks.find({}, { sort: { createdAt: -1 } }).fetch(),
+    incompleteCount: Tasks.find({ checked: { $ne: true } }).count(),
   };
 }, App);
-- 
2.5.1


From 88b91e3c6fa589a74d8ca4982267b5f62b04e090 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:24:09 -0700
Subject: [PATCH 21/50] Step 7.6: Display incompleteCount in the header

---
 imports/ui/App.jsx | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 75714e5..78e5548 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -51,7 +51,7 @@ class App extends Component {
     return (
       <div className="container">
         <header>
-          <h1>Todo List</h1>
+          <h1>Todo List ({this.props.incompleteCount})</h1>
 
           <label className="hide-completed">
             <input
@@ -82,6 +82,7 @@ class App extends Component {
 
 App.propTypes = {
   tasks: PropTypes.array.isRequired,
+  incompleteCount: PropTypes.number.isRequired,
 };
 
 export default createContainer(() => {
-- 
2.5.1


From 50e4ef5fbb938e9bc8a1efb8e787102fa01064b5 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:26:02 -0700
Subject: [PATCH 22/50] Step 8.1: Add accounts-ui and accounts-password
 packages

---
 .meteor/packages |  2 ++
 .meteor/versions | 15 +++++++++++++++
 2 files changed, 17 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index c3506d5..6c10fa5 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -20,3 +20,5 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
 react-meteor-data@0.2.6-beta.16
+accounts-ui
+accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index c4bc9da..ecdd0db 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,7 @@
+accounts-base@1.2.4-rc.2
+accounts-password@1.1.6-rc.2
+accounts-ui@1.1.7-rc.2
+accounts-ui-unstyled@1.1.10-rc.2
 allow-deny@1.0.2-rc.2
 autopublish@1.0.5-rc.2
 autoupdate@1.2.6-rc.2
@@ -16,12 +20,14 @@ check@1.1.2-rc.2
 ddp@1.2.3-rc.2
 ddp-client@1.2.3-rc.2
 ddp-common@1.2.3-rc.2
+ddp-rate-limiter@1.0.2-rc.2
 ddp-server@1.2.4-rc.2
 deps@1.0.10-rc.2
 diff-sequence@1.0.3-rc.2
 ecmascript@0.4.1-rc.2
 ecmascript-runtime@0.2.8-rc.2
 ejson@1.0.9-rc.2
+email@1.0.10-rc.2
 es5-shim@4.5.8-rc.2
 fastclick@1.0.9-rc.2
 geojson-utils@1.0.6-rc.2
@@ -33,7 +39,9 @@ id-map@1.0.5-rc.2
 insecure@1.0.5-rc.2
 jquery@1.11.6-rc.2
 launch-screen@1.0.7-rc.2
+less@2.5.5-rc.2
 livedata@1.0.16-rc.2
+localstorage@1.0.7-rc.2
 logging@1.0.10-rc.2
 meteor@1.1.12-rc.2
 meteor-base@1.0.2-rc.2
@@ -46,18 +54,25 @@ modules@0.5.1-rc.2
 modules-runtime@0.6.1-rc.2
 mongo@1.1.5-rc.2
 mongo-id@1.0.2-rc.2
+npm-bcrypt@0.7.8_2
 npm-mongo@1.4.41-rc.2
 observe-sequence@1.0.9-rc.2
 ordered-dict@1.0.5-rc.2
 promise@0.6.4-rc.2
 random@1.0.7-rc.2
+rate-limit@1.0.2-rc.2
 react-meteor-data@0.2.6-beta.16
+reactive-dict@1.1.5-rc.2
 reactive-var@1.0.7-rc.2
 reload@1.1.6-rc.2
 retry@1.0.5-rc.2
 routepolicy@1.0.8-rc.2
+service-configuration@1.0.7-rc.2
+session@1.1.3-rc.2
+sha@1.0.5-rc.2
 spacebars@1.0.9-rc.2
 spacebars-compiler@1.0.9-rc.2
+srp@1.0.6-rc.2
 standard-minifier-css@1.0.4-rc.2
 standard-minifier-js@1.0.4-rc.2
 templating@1.1.7-rc.2
-- 
2.5.1


From a20f5d2c9c80a2c3788375e20aebdecee91dd6df Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:26:59 -0700
Subject: [PATCH 23/50] Step 8.2: Create Accounts UI wrapper component

---
 imports/ui/AccountsUIWrapper.jsx | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)
 create mode 100644 imports/ui/AccountsUIWrapper.jsx

diff --git a/imports/ui/AccountsUIWrapper.jsx b/imports/ui/AccountsUIWrapper.jsx
new file mode 100644
index 0000000..208d5af
--- /dev/null
+++ b/imports/ui/AccountsUIWrapper.jsx
@@ -0,0 +1,20 @@
+import React, { Component } from 'react';
+import ReactDOM from 'react-dom';
+import { Template } from 'meteor/templating';
+import { Blaze } from 'meteor/blaze';
+
+export default class AccountsUIWrapper extends Component {
+  componentDidMount() {
+    // Use Meteor Blaze to render login buttons
+    this.view = Blaze.render(Template.loginButtons,
+      ReactDOM.findDOMNode(this.refs.container));
+  }
+  componentWillUnmount() {
+    // Clean up Blaze view
+    Blaze.remove(this.view);
+  }
+  render() {
+    // Just render a placeholder container that will be filled in
+    return <span ref="container" />;
+  }
+}
-- 
2.5.1


From 2dd978ae246e8eb6233292943ebb1e3e67278a61 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:27:36 -0700
Subject: [PATCH 24/50] Step 8.3: Include sign in form

---
 imports/ui/App.jsx | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 78e5548..1d0bbef 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -5,6 +5,7 @@ import { createContainer } from 'meteor/react-meteor-data';
 import { Tasks } from '../api/tasks.js';
 
 import Task from './Task.jsx';
+import AccountsUIWrapper from './AccountsUIWrapper.jsx';
 
 // App component - represents the whole app
 class App extends Component {
@@ -63,6 +64,8 @@ class App extends Component {
             Hide Completed Tasks
           </label>
 
+          <AccountsUIWrapper />
+
           <form className="new-task" onSubmit={this.handleSubmit.bind(this)} >
             <input
               type="text"
-- 
2.5.1


From cd967c38ce99f633d889e4cf035d8038b080bd25 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 16:13:48 +1100
Subject: [PATCH 25/50] Step 8.4: Configure accounts-ui

---
 imports/startup/accounts-config.js | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/startup/accounts-config.js

diff --git a/imports/startup/accounts-config.js b/imports/startup/accounts-config.js
new file mode 100644
index 0000000..7e4f7e5
--- /dev/null
+++ b/imports/startup/accounts-config.js
@@ -0,0 +1,5 @@
+import { Accounts } from 'meteor/accounts-base';
+
+Accounts.ui.config({
+  passwordSignupFields: 'USERNAME_ONLY',
+});
-- 
2.5.1


From 9d5328bd7b67bcaec7e2dd423768de443a8b313f Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 16:14:08 +1100
Subject: [PATCH 26/50] Step 8.5: Import accounts configuration

---
 client/main.jsx | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/main.jsx b/client/main.jsx
index 9ba3d08..b8c5033 100644
--- a/client/main.jsx
+++ b/client/main.jsx
@@ -2,6 +2,7 @@ import React from 'react';
 import { Meteor } from 'meteor/meteor';
 import { render } from 'react-dom';
 
+import '../imports/startup/accounts-config.js';
 import App from '../imports/ui/App.jsx';
 
 Meteor.startup(() => {
-- 
2.5.1


From 5aae2dbe6433bef2bb4374b261009e81fd354f4b Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:28:46 -0700
Subject: [PATCH 27/50] Step 8.6: Update insert to save username and owner

---
 imports/ui/App.jsx | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 1d0bbef..7694eb8 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -1,5 +1,6 @@
 import React, { Component, PropTypes } from 'react';
 import ReactDOM from 'react-dom';
+import { Meteor } from 'meteor/meteor';
 import { createContainer } from 'meteor/react-meteor-data';
 
 import { Tasks } from '../api/tasks.js';
@@ -26,6 +27,8 @@ class App extends Component {
     Tasks.insert({
       text,
       createdAt: new Date(), // current time
+      owner: Meteor.userId(),           // _id of logged in user
+      username: Meteor.user().username,  // username of logged in user
     });
 
     // Clear form
-- 
2.5.1


From f63fbe224d3ca4f52230eed5b5f3e533b9e020e4 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:29:16 -0700
Subject: [PATCH 28/50] Step 8.7: Update data container to return data about
 user

---
 imports/ui/App.jsx | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 7694eb8..ce0b541 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -95,5 +95,6 @@ export default createContainer(() => {
   return {
     tasks: Tasks.find({}, { sort: { createdAt: -1 } }).fetch(),
     incompleteCount: Tasks.find({ checked: { $ne: true } }).count(),
+    currentUser: Meteor.user(),
   };
 }, App);
-- 
2.5.1


From 779daa734436a32669485334900266330012ac5b Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:30:06 -0700
Subject: [PATCH 29/50] Step 8.8: Wrap new task form to only show when logged
 in

---
 imports/ui/App.jsx | 17 ++++++++++-------
 1 file changed, 10 insertions(+), 7 deletions(-)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index ce0b541..bbbb728 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -69,13 +69,15 @@ class App extends Component {
 
           <AccountsUIWrapper />
 
-          <form className="new-task" onSubmit={this.handleSubmit.bind(this)} >
-            <input
-              type="text"
-              ref="textInput"
-              placeholder="Type to add new tasks"
-            />
-          </form>
+          { this.props.currentUser ?
+            <form className="new-task" onSubmit={this.handleSubmit.bind(this)} >
+              <input
+                type="text"
+                ref="textInput"
+                placeholder="Type to add new tasks"
+              />
+            </form> : ''
+          }
         </header>
 
         <ul>
@@ -89,6 +91,7 @@ class App extends Component {
 App.propTypes = {
   tasks: PropTypes.array.isRequired,
   incompleteCount: PropTypes.number.isRequired,
+  currentUser: PropTypes.object,
 };
 
 export default createContainer(() => {
-- 
2.5.1


From 65f23f7a09821681c96ba1f70c87d5aa4dde0903 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:30:48 -0700
Subject: [PATCH 30/50] Step 8.9: Update Task component to show username

---
 imports/ui/Task.jsx | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/Task.jsx b/imports/ui/Task.jsx
index 3140871..5650fa0 100644
--- a/imports/ui/Task.jsx
+++ b/imports/ui/Task.jsx
@@ -33,7 +33,9 @@ export default class Task extends Component {
           onClick={this.toggleChecked.bind(this)}
         />
 
-        <span className="text">{this.props.task.text}</span>
+        <span className="text">
+          <strong>{this.props.task.username}</strong>: {this.props.task.text}
+        </span>
       </li>
     );
   }
-- 
2.5.1


From 8c55528020e197af7730fd5486d70abb86b7c616 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:31:22 -0700
Subject: [PATCH 31/50] Step 9.1: Remove insecure package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 6c10fa5..d6d446f 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,7 +18,6 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
-insecure                # Allow all DB writes from clients (for prototyping)
 react-meteor-data@0.2.6-beta.16
 accounts-ui
 accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index ecdd0db..011fbef 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -36,7 +36,6 @@ html-tools@1.0.7-rc.2
 htmljs@1.0.7-rc.2
 http@1.1.3-rc.2
 id-map@1.0.5-rc.2
-insecure@1.0.5-rc.2
 jquery@1.11.6-rc.2
 launch-screen@1.0.7-rc.2
 less@2.5.5-rc.2
-- 
2.5.1


From 8644804f6fe1b985b12f472699222195a8a8bf1f Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:32:21 -0700
Subject: [PATCH 32/50] Step 9.2: Add methods for add, remove, update task

---
 imports/api/tasks.js | 31 +++++++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
index 3bed819..af4962a 100644
--- a/imports/api/tasks.js
+++ b/imports/api/tasks.js
@@ -1,3 +1,34 @@
+import { Meteor } from 'meteor/meteor';
 import { Mongo } from 'meteor/mongo';
+import { check } from 'meteor/check';
 
 export const Tasks = new Mongo.Collection('tasks');
+
+Meteor.methods({
+  'tasks.insert'(text) {
+    check(text, String);
+
+    // Make sure the user is logged in before inserting a task
+    if (! this.userId) {
+      throw new Meteor.Error('not-authorized');
+    }
+
+    Tasks.insert({
+      text,
+      createdAt: new Date(),
+      owner: this.userId,
+      username: Meteor.users.findOne(this.userId).username,
+    });
+  },
+  'tasks.remove'(taskId) {
+    check(taskId, String);
+
+    Tasks.remove(taskId);
+  },
+  'tasks.setChecked'(taskId, setChecked) {
+    check(taskId, String);
+    check(setChecked, Boolean);
+
+    Tasks.update(taskId, { $set: { checked: setChecked } });
+  },
+});
-- 
2.5.1


From f1d1bea80f6bcf6b5f88385c8e39687a72cab5d3 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:32:59 -0700
Subject: [PATCH 33/50] Step 9.3: Update App component to use tasks.insert
 method

---
 imports/ui/App.jsx | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index bbbb728..4f41c39 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -24,12 +24,7 @@ class App extends Component {
     // Find the text field via the React ref
     const text = ReactDOM.findDOMNode(this.refs.textInput).value.trim();
 
-    Tasks.insert({
-      text,
-      createdAt: new Date(), // current time
-      owner: Meteor.userId(),           // _id of logged in user
-      username: Meteor.user().username,  // username of logged in user
-    });
+    Meteor.call('tasks.insert', text);
 
     // Clear form
     ReactDOM.findDOMNode(this.refs.textInput).value = '';
-- 
2.5.1


From badfb4f30432c960f8f2c93a8bbc60af76ac1ea8 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:33:38 -0700
Subject: [PATCH 34/50] Step 9.4: Replace update and remove with methods

---
 imports/ui/Task.jsx | 9 +++------
 1 file changed, 3 insertions(+), 6 deletions(-)

diff --git a/imports/ui/Task.jsx b/imports/ui/Task.jsx
index 5650fa0..ee040c5 100644
--- a/imports/ui/Task.jsx
+++ b/imports/ui/Task.jsx
@@ -1,18 +1,15 @@
 import React, { Component, PropTypes } from 'react';
-
-import { Tasks } from '../api/tasks.js';
+import { Meteor } from 'meteor/meteor';
 
 // Task component - represents a single todo item
 export default class Task extends Component {
   toggleChecked() {
     // Set the checked property to the opposite of its current value
-    Tasks.update(this.props.task._id, {
-      $set: { checked: !this.props.task.checked },
-    });
+    Meteor.call('tasks.setChecked', this.props.task._id, !this.props.task.checked);
   }
 
   deleteThisTask() {
-    Tasks.remove(this.props.task._id);
+    Meteor.call('tasks.remove', this.props.task._id);
   }
 
   render() {
-- 
2.5.1


From f848ec1d44047bc61947c2033f54592abd120f38 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:34:33 -0700
Subject: [PATCH 35/50] Step 10.1: Remove autopublish package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index d6d446f..6ec9016 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -17,7 +17,6 @@ standard-minifier-js    # JS minifier run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 ecmascript              # Enable ECMAScript2015+ syntax in app code
 
-autopublish             # Publish all data to the clients (for prototyping)
 react-meteor-data@0.2.6-beta.16
 accounts-ui
 accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index 011fbef..cee5a46 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -3,7 +3,6 @@ accounts-password@1.1.6-rc.2
 accounts-ui@1.1.7-rc.2
 accounts-ui-unstyled@1.1.10-rc.2
 allow-deny@1.0.2-rc.2
-autopublish@1.0.5-rc.2
 autoupdate@1.2.6-rc.2
 babel-compiler@6.5.1-rc.2
 babel-runtime@0.1.6-rc.2
-- 
2.5.1


From 8591e2902b367fc2e3e25bcf6c683505e1b23b57 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 16:27:05 +1100
Subject: [PATCH 36/50] Step 10.2: Add publication for tasks

---
 imports/api/tasks.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
index af4962a..80d36bc 100644
--- a/imports/api/tasks.js
+++ b/imports/api/tasks.js
@@ -4,6 +4,13 @@ import { check } from 'meteor/check';
 
 export const Tasks = new Mongo.Collection('tasks');
 
+if (Meteor.isServer) {
+  // This code only runs on the server
+  Meteor.publish('tasks', function tasksPublication() {
+    return Tasks.find();
+  });
+}
+
 Meteor.methods({
   'tasks.insert'(text) {
     check(text, String);
-- 
2.5.1


From bdab4ed3dec3368ac6f331b70d8997ccbba85748 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 16:28:14 +1100
Subject: [PATCH 37/50] Step 10.3: Subscribe to tasks in App container

---
 imports/ui/App.jsx | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index 4f41c39..d6e5f0a 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -90,6 +90,8 @@ App.propTypes = {
 };
 
 export default createContainer(() => {
+  Meteor.subscribe('tasks');
+
   return {
     tasks: Tasks.find({}, { sort: { createdAt: -1 } }).fetch(),
     incompleteCount: Tasks.find({ checked: { $ne: true } }).count(),
-- 
2.5.1


From 285d4760f5ec9c55a6235f3ad8aaac803057642b Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:36:29 -0700
Subject: [PATCH 38/50] Step 10.4: Add tasks.setPrivate method

---
 imports/api/tasks.js | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
index 80d36bc..63feeca 100644
--- a/imports/api/tasks.js
+++ b/imports/api/tasks.js
@@ -38,4 +38,17 @@ Meteor.methods({
 
     Tasks.update(taskId, { $set: { checked: setChecked } });
   },
+  'tasks.setPrivate'(taskId, setToPrivate) {
+    check(taskId, String);
+    check(setToPrivate, Boolean);
+
+    const task = Tasks.findOne(taskId);
+
+    // Make sure only the task owner can make a task private
+    if (task.owner !== this.userId) {
+      throw new Meteor.Error('not-authorized');
+    }
+
+    Tasks.update(taskId, { $set: { private: setToPrivate } });
+  },
 });
-- 
2.5.1


From 7ad3a79778614fbcda8f694e8ea3079e3220997b Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:36:59 -0700
Subject: [PATCH 39/50] Step 10.5: Update renderTasks to pass in
 showPrivateButton

---
 imports/ui/App.jsx | 15 ++++++++++++---
 1 file changed, 12 insertions(+), 3 deletions(-)

diff --git a/imports/ui/App.jsx b/imports/ui/App.jsx
index d6e5f0a..06262c5 100644
--- a/imports/ui/App.jsx
+++ b/imports/ui/App.jsx
@@ -41,9 +41,18 @@ class App extends Component {
     if (this.state.hideCompleted) {
       filteredTasks = filteredTasks.filter(task => !task.checked);
     }
-    return filteredTasks.map((task) => (
-      <Task key={task._id} task={task} />
-    ));
+    return filteredTasks.map((task) => {
+      const currentUserId = this.props.currentUser && this.props.currentUser._id;
+      const showPrivateButton = task.owner === currentUserId;
+
+      return (
+        <Task
+          key={task._id}
+          task={task}
+          showPrivateButton={showPrivateButton}
+        />
+      );
+    });
   }
 
   render() {
-- 
2.5.1


From e30683e5e8e6a4857ffb4d82998e2dc1f88f6f96 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:37:28 -0700
Subject: [PATCH 40/50] Step 10.6: Add a new prop type for Task component

---
 imports/ui/Task.jsx | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/Task.jsx b/imports/ui/Task.jsx
index ee040c5..deba74a 100644
--- a/imports/ui/Task.jsx
+++ b/imports/ui/Task.jsx
@@ -42,4 +42,5 @@ Task.propTypes = {
   // This component gets the task to display through a React prop.
   // We can use propTypes to indicate it is required
   task: PropTypes.object.isRequired,
+  showPrivateButton: React.PropTypes.bool.isRequired,
 };
-- 
2.5.1


From 0e7793113ec7b62fa9f292a31c5a728f866a8ecb Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:38:04 -0700
Subject: [PATCH 41/50] Step 10.7: Add private button, shown only to owner

---
 imports/ui/Task.jsx | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/imports/ui/Task.jsx b/imports/ui/Task.jsx
index deba74a..bec76ba 100644
--- a/imports/ui/Task.jsx
+++ b/imports/ui/Task.jsx
@@ -30,6 +30,12 @@ export default class Task extends Component {
           onClick={this.toggleChecked.bind(this)}
         />
 
+        { this.props.showPrivateButton ? (
+          <button className="toggle-private" onClick={this.togglePrivate.bind(this)}>
+            { this.props.task.private ? 'Private' : 'Public' }
+          </button>
+        ) : ''}
+
         <span className="text">
           <strong>{this.props.task.username}</strong>: {this.props.task.text}
         </span>
-- 
2.5.1


From 29689a1d655d68fe64b14d8fe8279868370dd8d8 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:38:33 -0700
Subject: [PATCH 42/50] Step 10.8: Add private button event handler to Task

---
 imports/ui/Task.jsx | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/Task.jsx b/imports/ui/Task.jsx
index bec76ba..db0999e 100644
--- a/imports/ui/Task.jsx
+++ b/imports/ui/Task.jsx
@@ -12,6 +12,10 @@ export default class Task extends Component {
     Meteor.call('tasks.remove', this.props.task._id);
   }
 
+  togglePrivate() {
+    Meteor.call('tasks.setPrivate', this.props.task._id, ! this.props.task.private);
+  }
+
   render() {
     // Give tasks a different className when they are checked off,
     // so that we can style them nicely in CSS
-- 
2.5.1


From 7b60d6331ec9feaf09c74b82f4d3d5ad4c7bbf28 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 16:33:06 +1100
Subject: [PATCH 43/50] Step 10.9: Install the classnames NPM package

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index fb213f3..ad97bd8 100644
--- a/package.json
+++ b/package.json
@@ -5,6 +5,7 @@
     "start": "meteor run"
   },
   "dependencies": {
+    "classnames": "^2.2.3",
     "meteor-node-stubs": "~0.2.0",
     "react": "^0.14.7",
     "react-addons-pure-render-mixin": "^0.14.7",
-- 
2.5.1


From 9b34c5a16bd84c0fd812183c1386c31282e4d297 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:39:22 -0700
Subject: [PATCH 44/50] Step 10.10: Add private className to Task when needed

---
 imports/ui/Task.jsx | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/imports/ui/Task.jsx b/imports/ui/Task.jsx
index db0999e..52450c3 100644
--- a/imports/ui/Task.jsx
+++ b/imports/ui/Task.jsx
@@ -1,5 +1,6 @@
 import React, { Component, PropTypes } from 'react';
 import { Meteor } from 'meteor/meteor';
+import classnames from 'classnames';
 
 // Task component - represents a single todo item
 export default class Task extends Component {
@@ -19,7 +20,10 @@ export default class Task extends Component {
   render() {
     // Give tasks a different className when they are checked off,
     // so that we can style them nicely in CSS
-    const taskClassName = this.props.task.checked ? 'checked' : '';
+    const taskClassName = classnames({
+      checked: this.props.task.checked,
+      private: this.props.task.private,
+    });
 
     return (
       <li className={taskClassName}>
-- 
2.5.1


From 3eaef91a100f3284e2574c6bbcd81223b75d7e45 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:39:58 -0700
Subject: [PATCH 45/50] Step 10.11: Only publish tasks the current user can see

---
 imports/api/tasks.js | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
index 63feeca..5f76880 100644
--- a/imports/api/tasks.js
+++ b/imports/api/tasks.js
@@ -6,8 +6,14 @@ export const Tasks = new Mongo.Collection('tasks');
 
 if (Meteor.isServer) {
   // This code only runs on the server
+  // Only publish tasks that are public or belong to the current user
   Meteor.publish('tasks', function tasksPublication() {
-    return Tasks.find();
+    return Tasks.find({
+      $or: [
+        { private: { $ne: true } },
+        { owner: this.userId },
+      ],
+    });
   });
 }
 
-- 
2.5.1


From 2a2203f90f995f21b281d21a79888f4c5c17bc34 Mon Sep 17 00:00:00 2001
From: Sashko Stubailo <sashko@stubailo.com>
Date: Mon, 13 Jul 2015 12:40:55 -0700
Subject: [PATCH 46/50] Step 10.12: Add extra security to methods

---
 imports/api/tasks.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/imports/api/tasks.js b/imports/api/tasks.js
index 5f76880..d7d72dd 100644
--- a/imports/api/tasks.js
+++ b/imports/api/tasks.js
@@ -36,12 +36,24 @@ Meteor.methods({
   'tasks.remove'(taskId) {
     check(taskId, String);
 
+    const task = Tasks.findOne(taskId);
+    if (task.private && task.owner !== this.userId) {
+      // If the task is private, make sure only the owner can delete it
+      throw new Meteor.Error('not-authorized');
+    }
+
     Tasks.remove(taskId);
   },
   'tasks.setChecked'(taskId, setChecked) {
     check(taskId, String);
     check(setChecked, Boolean);
 
+    const task = Tasks.findOne(taskId);
+    if (task.private && task.owner !== this.userId) {
+      // If the task is private, make sure only the owner can check it off
+      throw new Meteor.Error('not-authorized');
+    }
+
     Tasks.update(taskId, { $set: { checked: setChecked } });
   },
   'tasks.setPrivate'(taskId, setToPrivate) {
-- 
2.5.1


From 923ba502580719af8edce6bf446a82318d29349f Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 16:35:58 +1100
Subject: [PATCH 47/50] Step 11.1: Added practicalmeteor:mocha package

---
 .meteor/packages | 1 +
 .meteor/versions | 6 ++++++
 2 files changed, 7 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 6ec9016..7e39952 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -20,3 +20,4 @@ ecmascript              # Enable ECMAScript2015+ syntax in app code
 react-meteor-data@0.2.6-beta.16
 accounts-ui
 accounts-password
+practicalmeteor:mocha
diff --git a/.meteor/versions b/.meteor/versions
index cee5a46..53843b3 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -16,6 +16,7 @@ caching-compiler@1.0.2-rc.2
 caching-html-compiler@1.0.4-rc.2
 callback-hook@1.0.6-rc.2
 check@1.1.2-rc.2
+coffeescript@1.0.15-rc.2
 ddp@1.2.3-rc.2
 ddp-client@1.2.3-rc.2
 ddp-common@1.2.3-rc.2
@@ -56,6 +57,11 @@ npm-bcrypt@0.7.8_2
 npm-mongo@1.4.41-rc.2
 observe-sequence@1.0.9-rc.2
 ordered-dict@1.0.5-rc.2
+practicalmeteor:chai@2.1.0_1
+practicalmeteor:loglevel@1.2.0_2
+practicalmeteor:mocha@2.1.0_7
+practicalmeteor:mocha-core@0.1.4
+practicalmeteor:sinon@1.14.1_2
 promise@0.6.4-rc.2
 random@1.0.7-rc.2
 rate-limit@1.0.2-rc.2
-- 
2.5.1


From 64b6e3ffb5c69b445f4de66a9cdbb2342cd4da83 Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 16:36:17 +1100
Subject: [PATCH 48/50] Step 11.2: Add a scaffold for a method test

---
 imports/api/tasks.tests.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)
 create mode 100644 imports/api/tasks.tests.js

diff --git a/imports/api/tasks.tests.js b/imports/api/tasks.tests.js
new file mode 100644
index 0000000..05287ba
--- /dev/null
+++ b/imports/api/tasks.tests.js
@@ -0,0 +1,12 @@
+/* eslint-env mocha */
+
+import { Meteor } from 'meteor/meteor';
+
+if (Meteor.isServer) {
+  describe('Tasks', () => {
+    describe('methods', () => {
+      it('can delete owned task', () => {
+      });
+    });
+  });
+}
-- 
2.5.1


From 3a7d4430dbcf87f5f7f4e83d9550b8b4773ac02e Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 16:36:29 +1100
Subject: [PATCH 49/50] Step 11.3: Prepare the database for each test

---
 imports/api/tasks.tests.js | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

diff --git a/imports/api/tasks.tests.js b/imports/api/tasks.tests.js
index 05287ba..1359e85 100644
--- a/imports/api/tasks.tests.js
+++ b/imports/api/tasks.tests.js
@@ -1,10 +1,26 @@
 /* eslint-env mocha */
 
 import { Meteor } from 'meteor/meteor';
+import { Random } from 'meteor/random';
+
+import { Tasks } from './tasks.js';
 
 if (Meteor.isServer) {
   describe('Tasks', () => {
     describe('methods', () => {
+      const userId = Random.id();
+      let taskId;
+
+      beforeEach(() => {
+        Tasks.remove({});
+        taskId = Tasks.insert({
+          text: 'test task',
+          createdAt: new Date(),
+          owner: userId,
+          username: 'tmeasday',
+        });
+      });
+
       it('can delete owned task', () => {
       });
     });
-- 
2.5.1


From 15cf3fbd87b0d9b9e9aa5779e8ec4198e3e1016b Mon Sep 17 00:00:00 2001
From: Tom Coleman <tom@thesnail.org>
Date: Fri, 18 Mar 2016 16:36:42 +1100
Subject: [PATCH 50/50] Step 11.4: Added test to check delete method

---
 imports/api/tasks.tests.js | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/imports/api/tasks.tests.js b/imports/api/tasks.tests.js
index 1359e85..9b61c5a 100644
--- a/imports/api/tasks.tests.js
+++ b/imports/api/tasks.tests.js
@@ -2,6 +2,7 @@
 
 import { Meteor } from 'meteor/meteor';
 import { Random } from 'meteor/random';
+import { assert } from 'meteor/practicalmeteor:chai';
 
 import { Tasks } from './tasks.js';
 
@@ -22,6 +23,18 @@ if (Meteor.isServer) {
       });
 
       it('can delete owned task', () => {
+        // Find the internal implementation of the task method so we can
+        // test it in isolation
+        const deleteTask = Meteor.server.method_handlers['tasks.remove'];
+
+        // Set up a fake method invocation that looks like what the method expects
+        const invocation = { userId };
+
+        // Run the method with `this` set to the fake invocation
+        deleteTask.apply(invocation, [taskId]);
+
+        // Verify that the method does what we expected
+        assert.equal(Tasks.find().count(), 0);
       });
     });
   });
-- 
2.5.1

